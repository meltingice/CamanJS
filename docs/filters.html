<!DOCTYPE html>  <html> <head>   <title>filters.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="events.html">                 events.js               </a>                                           <a class="source" href="filters.html">                 filters.js               </a>                                           <a class="source" href="header.html">                 header.js               </a>                                           <a class="source" href="io.html">                 io.js               </a>                                           <a class="source" href="layers.html">                 layers.js               </a>                                           <a class="source" href="loader.html">                 loader.js               </a>                                           <a class="source" href="pixelInfo.html">                 pixelInfo.js               </a>                                           <a class="source" href="render.html">                 render.js               </a>                                           <a class="source" href="util.html">                 util.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               filters.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>The filters define all of the built-in functionality that comes with Caman 
(as opposed to being provided by a plugin). All of these filters are rather 
basic, but are extremely powerful when many are combined. For information on 
creating plugins, check out the <a href="http://camanjs.com/docs/plugin-creation">Plugin Creation</a>
page, and for information on using the plugins, check out the
<a href="http://camanjs.com/docs/built-in">Built-In Functionality</a> page.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*global Caman: true */</span> 
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Caman</span><span class="p">)</span> <span class="p">{</span>
  </pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Fill Color</h2>

<p>Fills the canvas with a single solid color.</p>

<h3>Arguments</h3>

<p>Can take either separate R, G, and B values as arguments, or a single hex color value.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">fillColor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">color</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>If there's only 1 argument present, assume its a hex color and convert it to RGB.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">color</span> <span class="o">=</span> <span class="nx">Caman</span><span class="p">.</span><span class="nx">hex_to_rgb</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">color</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">r</span><span class="o">:</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="nx">g</span><span class="o">:</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="nx">b</span><span class="o">:</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
      <span class="p">};</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Simply set every pixel in the canvas to the given RGB color.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span> <span class="nx">color</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">fillColor</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nx">color</span><span class="p">.</span><span class="nx">r</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">color</span><span class="p">.</span><span class="nx">g</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">color</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h2>Brightness</h2>

<p>Simple brightness adjustment</p>

<h3>Arguments</h3>

<p>Range is -100 to 100. Values &lt; 0 will darken image while values > 0 will brighten.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">brightness</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">adjust</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="p">(</span><span class="nx">adjust</span> <span class="o">/</span> <span class="mi">100</span><span class="p">));</span>
    </pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Simply increase all 3 color channels by the given amount</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span> <span class="nx">adjust</span><span class="p">,</span>  <span class="kd">function</span> <span class="nx">brightness</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">+=</span> <span class="nx">adjust</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">+=</span> <span class="nx">adjust</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">+=</span> <span class="nx">adjust</span><span class="p">;</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <h2>Saturation</h2>

<p>Adjusts the color saturation of the image.</p>

<h3>Arguments</h3>

<p>Range is -100 to 100. Values &lt; 0 will desaturate the image while values > 0 will saturate it.
<strong>If you want to completely desaturate the image</strong>, using the greyscale filter is highly 
recommended because it will yield better results.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">saturation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">max</span><span class="p">,</span> <span class="nx">diff</span><span class="p">;</span>
    <span class="nx">adjust</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span> <span class="nx">adjust</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">saturation</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">chan</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Find the max value across all 3 channels</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">max</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">);</span>
      </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Go through each channel, and if it isn't the max, adjust it by the given amount.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">!==</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">diff</span> <span class="o">=</span> <span class="nx">max</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span><span class="p">;</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">+=</span> <span class="nx">diff</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">!==</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">diff</span> <span class="o">=</span> <span class="nx">max</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span><span class="p">;</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">+=</span> <span class="nx">diff</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">;</span> 
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">!==</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">diff</span> <span class="o">=</span> <span class="nx">max</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">+=</span> <span class="nx">diff</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h2>Vibrance</h2>

<p>Similar to saturation, but adjusts the saturation levels in a slightly smarter, more subtle way. 
Vibrance will attempt to boost colors that are less saturated more and boost already saturated
colors less, while saturation boosts all colors by the same level.</p>

<h3>Arguments</h3>

<p>Range is -100 to 100. Values &lt; 0 will desaturate the image while values > 0 will saturate it.
<strong>If you want to completely desaturate the image</strong>, using the greyscale filter is highly recommended
because it will yield better results.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">vibrance</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">max</span><span class="p">,</span> <span class="nx">avg</span><span class="p">,</span> <span class="nx">amt</span><span class="p">,</span> <span class="nx">diff</span><span class="p">;</span>
    <span class="nx">adjust</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span> <span class="nx">adjust</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">vibrance</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">chan</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Find the max value across all 3 channels</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">max</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">);</span>
      </pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Calculate difference between max color and other colors</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">avg</span> <span class="o">=</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">+</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">+</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">;</span>
      <span class="nx">amt</span> <span class="o">=</span> <span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">max</span> <span class="o">-</span> <span class="nx">avg</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Go through each channel, and if it isn't the max, adjust it by the weighted given amount.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">!==</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">diff</span> <span class="o">=</span> <span class="nx">max</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span><span class="p">;</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">+=</span> <span class="nx">diff</span> <span class="o">*</span> <span class="nx">amt</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">!==</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">diff</span> <span class="o">=</span> <span class="nx">max</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span><span class="p">;</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">+=</span> <span class="nx">diff</span> <span class="o">*</span> <span class="nx">amt</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">!==</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">diff</span> <span class="o">=</span> <span class="nx">max</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">+=</span> <span class="nx">diff</span> <span class="o">*</span> <span class="nx">amt</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h2>Greyscale</h2>

<p>An improved greyscale function that should make prettier results
than simply using the saturation filter to remove color. It does so by using factors
that directly relate to how the human eye perceves color and values. There are
no arguments, it simply makes the image greyscale with no in-between.</p>

<p>Algorithm adopted from http://www.phpied.com/image-fun/</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">greyscale</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">({},</span> <span class="kd">function</span> <span class="nx">greyscale</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Calculate the average value of the 3 color channels using the special factors</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">avg</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">+</span> <span class="mf">0.59</span> <span class="o">*</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">+</span> <span class="mf">0.11</span> <span class="o">*</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Set all color channels to the same average value</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nx">avg</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">avg</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">avg</span><span class="p">;</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <h2>Contrast</h2>

<p>Increases or decreases the color contrast of the image.</p>

<h3>Arguments</h3>

<p>Range is -100 to 100. Values &lt; 0 will decrease contrast while values > 0 will increase contrast.
The contrast adjustment values are a bit sensitive. While unrestricted, sane adjustment values are
usually around 5-10.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">contrast</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">adjust</span> <span class="o">=</span> <span class="p">(</span><span class="nx">adjust</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
    <span class="nx">adjust</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span> <span class="nx">adjust</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">contrast</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Red channel</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">/=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">-=</span> <span class="mf">0.5</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">*=</span> <span class="nx">adjust</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">+=</span> <span class="mf">0.5</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">*=</span> <span class="mi">255</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Green channel</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">/=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">-=</span> <span class="mf">0.5</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">*=</span> <span class="nx">adjust</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">+=</span> <span class="mf">0.5</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">*=</span> <span class="mi">255</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Blue channel</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">/=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">-=</span> <span class="mf">0.5</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">*=</span> <span class="nx">adjust</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">+=</span> <span class="mf">0.5</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">*=</span> <span class="mi">255</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>While uglier, I found that using if statements are
faster than calling Math.max() and Math.min() to bound
the numbers.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
              
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <h2>Hue</h2>

<p>Adjusts the hue of the image. It can be used to shift the colors in an image in a uniform fashion.
If you are unfamiliar with Hue, I recommend reading this <a href="http://en.wikipedia.org/wiki/Hue">Wikipedia article</a>.</p>

<h3>Arguments</h3>

<p>Range is 0 to 100
Sometimes, Hue is expressed in the range of 0 to 360. If that's the terminology you're used to, think of 0 to 100
representing the percentage of Hue shift in the 0 to 360 range.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">hue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hsv</span><span class="p">,</span> <span class="nx">h</span><span class="p">;</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span> <span class="nx">adjust</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">hue</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">rgb</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Convert current pixel to HSV color space</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">hsv</span> <span class="o">=</span> <span class="nx">Caman</span><span class="p">.</span><span class="nx">rgb_to_hsv</span><span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">);</span>
      </pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Convert the hue percentage to a non-fractional number out of 100</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">h</span> <span class="o">=</span> <span class="nx">hsv</span><span class="p">.</span><span class="nx">h</span> <span class="o">*</span> <span class="mi">100</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Shift the hue value by the given amount</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">h</span> <span class="o">+=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">adjust</span><span class="p">);</span>
      </pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Wrap the shift around if it goes over 100.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">h</span> <span class="o">=</span> <span class="nx">h</span> <span class="o">%</span> <span class="mi">100</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Convert the hue back into a percentage</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">h</span> <span class="o">/=</span> <span class="mi">100</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Apply the updated hue value</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">hsv</span><span class="p">.</span><span class="nx">h</span> <span class="o">=</span> <span class="nx">h</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Convert back to RGB color space</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">rgb</span> <span class="o">=</span> <span class="nx">Caman</span><span class="p">.</span><span class="nx">hsv_to_rgb</span><span class="p">(</span><span class="nx">hsv</span><span class="p">.</span><span class="nx">h</span><span class="p">,</span> <span class="nx">hsv</span><span class="p">.</span><span class="nx">s</span><span class="p">,</span> <span class="nx">hsv</span><span class="p">.</span><span class="nx">v</span><span class="p">);</span>
      
      <span class="k">return</span> <span class="p">{</span><span class="nx">r</span><span class="o">:</span> <span class="nx">rgb</span><span class="p">.</span><span class="nx">r</span><span class="p">,</span> <span class="nx">g</span><span class="o">:</span> <span class="nx">rgb</span><span class="p">.</span><span class="nx">g</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="nx">rgb</span><span class="p">.</span><span class="nx">b</span><span class="p">};</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <h2>Colorize</h2>

<p>Uniformly shifts the colors in an image towards the given color. The adjustment range is from 0 to 100. 
The higher the value, the closer the colors in the image shift towards the given adjustment color.</p>

<h3>Arguments</h3>

<p>This filter is polymorphic and can take two different sets of arguments. Either a hex color string and an adjustment
value, or RGB colors and an adjustment value.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">colorize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">diff</span><span class="p">,</span> <span class="nx">rgb</span><span class="p">,</span> <span class="nx">level</span><span class="p">;</span>
            
    <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>If only 2 arguments, assume we were given a hex color string</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">rgb</span> <span class="o">=</span> <span class="nx">Caman</span><span class="p">.</span><span class="nx">hex_to_rgb</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
      <span class="nx">level</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Otherwise assume we have RGB colors</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">rgb</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">r</span><span class="o">:</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="nx">g</span><span class="o">:</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="nx">b</span><span class="o">:</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>        
      <span class="p">};</span>
      
      <span class="nx">level</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span> <span class="p">[</span> <span class="nx">level</span><span class="p">,</span> <span class="nx">rgb</span> <span class="p">],</span>  <span class="kd">function</span> <span class="nx">colorize</span><span class="p">(</span> <span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>adjust[0] == level; adjust[1] == rgb;</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">-=</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">-</span> <span class="nx">adjust</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">r</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">-=</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">-</span> <span class="nx">adjust</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">g</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">-=</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">-</span> <span class="nx">adjust</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>
        
        <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <h2>Invert</h2>

<p>Inverts all colors in the image by subtracting each color channel value from 255. No arguments.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">invert</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">({},</span> <span class="kd">function</span> <span class="nx">invert</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <h2>Sepia</h2>

<p>Applies an adjustable sepia filter to the image.</p>

<h3>Arguments</h3>

<p>Assumes adjustment is between 0 and 100, which represents how much the sepia filter is applied.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">sepia</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>If no adjustment value was given, assume 100% sepia</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">adjust</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">adjust</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Convert to percentage</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">adjust</span> <span class="o">=</span> <span class="p">(</span><span class="nx">adjust</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>
    </pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>All three color channels have special conversion factors that define what sepia is. Here we adjust each
channel individually, with the twist that you can partially apply the sepia filter.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">sepia</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.607</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.769</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.189</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">)));</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.349</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.314</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.168</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">)));</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.272</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.534</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="p">(</span><span class="mf">0.869</span> <span class="o">*</span> <span class="nx">adjust</span><span class="p">))));</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <h2>Gamma</h2>

<p>Adjusts the gamma of the image.</p>

<h3>Arguments</h3>

<p>Range is from 0 to infinity, although sane values are from 0 to 4 or 5.
Values between 0 and 1 will lessen the contrast while values greater than 1 will increase it.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">gamma</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">gamma</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="nx">adjust</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="nx">adjust</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="nx">adjust</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <h2>Noise</h2>

<p>Adds noise to the image on a scale from 1 - 100. However, the scale isn't constrained, so you can specify
a value > 100 if you want a LOT of noise.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">noise</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Convert the percentage into a 0 - 255 range.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">adjust</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.55</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">noise</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Retrieve a random number between -adjust and adjust</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">rand</span> <span class="o">=</span> <span class="nx">Caman</span><span class="p">.</span><span class="nx">randomRange</span><span class="p">(</span><span class="nx">adjust</span><span class="o">*-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">adjust</span><span class="p">);</span>
      </pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Apply the random value to each color channel to adjust the brightness. This will be clamped automatically
by Caman later on if it goes below 0 or over 255.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">+=</span> <span class="nx">rand</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">+=</span> <span class="nx">rand</span><span class="p">;</span>
      <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">+=</span> <span class="nx">rand</span><span class="p">;</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <h2>Clip</h2>

<p>Clips a color to max values when it falls outside of the specified range.</p>

<h3>Arguments</h3>

<p>Supplied value should be between 0 and 100.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">clip</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Convert the percentage into a 0 - 255 range.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">adjust</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.55</span><span class="p">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Go through each color channel, and clip the color if it falls outside of the
specified range.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">clip</span><span class="p">(</span><span class="nx">adjust</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="o">-</span> <span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">&lt;</span> <span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="o">-</span> <span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">&lt;</span> <span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="o">-</span> <span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">&lt;</span> <span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <h2>Channels</h2>

<p>Lets you modify the intensity of any combination of red, green, or blue channels individually.</p>

<h3>Arguments</h3>

<p>Must be given at least one color channel to adjust in order to work.
Options format (must specify 1 - 3 colors):</p>

<pre>{
  red: 20,
  green: -5,
  blue: -40
}</pre>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">channels</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>Clean up the arguments object a bit</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">chan</span> <span class="k">in</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">chan</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">[</span><span class="nx">chan</span><span class="p">]</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">delete</span> <span class="nx">options</span><span class="p">[</span><span class="nx">chan</span><span class="p">];</span>
          <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Convert to a percentage</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">options</span><span class="p">[</span><span class="nx">chan</span><span class="p">]</span> <span class="o">=</span> <span class="nx">options</span><span class="p">[</span><span class="nx">chan</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>If there are no color channels, simply return</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>Go through each color channel and adjust it towards the given color.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">channels</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">red</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">red</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>fraction of the distance between current color and 255</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">+</span> <span class="p">((</span><span class="mi">255</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span><span class="p">)</span> <span class="o">*</span> <span class="nx">options</span><span class="p">.</span><span class="nx">red</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>adjust away from the given color</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">-</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">r</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">red</span><span class="p">));</span>
        <span class="p">}</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">green</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">green</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">+</span> <span class="p">((</span><span class="mi">255</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span><span class="p">)</span> <span class="o">*</span> <span class="nx">options</span><span class="p">.</span><span class="nx">green</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">-</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">g</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">green</span><span class="p">));</span>
        <span class="p">}</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">blue</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">blue</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">+</span> <span class="p">((</span><span class="mi">255</span> <span class="o">-</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span><span class="p">)</span> <span class="o">*</span> <span class="nx">options</span><span class="p">.</span><span class="nx">blue</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">-</span> <span class="p">(</span><span class="nx">rgba</span><span class="p">.</span><span class="nx">b</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">blue</span><span class="p">));</span>
        <span class="p">}</span>
      <span class="p">}</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <h2>Curves</h2>

<p>Curves implementation using Bezier curve equation. If you're familiar with the Curves functionality in Photoshop, 
this works in a very similar fashion.</p>

<h3>Arguments.</h3>

<pre>
  chan - [r, g, b, rgb]
  start - [x, y] (start of curve; 0 - 255)
  ctrl1 - [x, y] (control point 1; 0 - 255)
  ctrl2 - [x, y] (control point 2; 0 - 255)
  end   - [x, y] (end of curve; 0 - 255)
</pre>

<p>The first argument represents the channels you wish to modify with the filter. It can be an array of channels or a 
string (for a single channel). The rest of the arguments are 2-element arrays that represent point coordinates.
They are specified in the same order as shown in this image to the right. The coordinates are in the range of\
0 to 255 for both X and Y values.</p>

<p>The x-axis represents the input value for a single channel, while the y-axis represents the output value.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">curves</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">chan</span><span class="p">,</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">ctrl1</span><span class="p">,</span> <span class="nx">ctrl2</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">bezier</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>If the channel(s) given are in the form of a string, split them into
an array.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">chan</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">chan</span> <span class="o">=</span> <span class="nx">chan</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Generate a bezier curve with the given arguments, clamped between 0 and 255</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">bezier</span> <span class="o">=</span> <span class="nx">Caman</span><span class="p">.</span><span class="nx">bezier</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">ctrl1</span><span class="p">,</span> <span class="nx">ctrl2</span><span class="p">,</span> <span class="nx">end</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">);</span>
    </pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>If our curve starts after x = 0, initialize it with a flat line until
the curve begins.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">start</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">bezier</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">start</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>... and the same with the end point</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">end</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">end</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">255</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">bezier</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">end</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>Once we have the complete bezier curve, it's a simple matter of using the array index
as the input value to get the output color value.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">process</span><span class="p">({</span><span class="nx">bezier</span><span class="o">:</span> <span class="nx">bezier</span><span class="p">,</span> <span class="nx">chans</span><span class="o">:</span> <span class="nx">chan</span><span class="p">},</span> <span class="kd">function</span> <span class="nx">curves</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">rgba</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">chans</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rgba</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">chans</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">bezier</span><span class="p">[</span><span class="nx">rgba</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">chans</span><span class="p">[</span><span class="nx">i</span><span class="p">]]];</span>
      <span class="p">}</span>
      
      <span class="k">return</span> <span class="nx">rgba</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <h2>Exposure</h2>

<p>Adjusts the exposure of the image by using the curves function.</p>

<h3>Arguments</h3>

<p>Range is -100 to 100. Values &lt; 0 will decrease exposure while values > 0 will increase exposure.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Caman</span><span class="p">.</span><span class="nx">manip</span><span class="p">.</span><span class="nx">exposure</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">ctrl1</span><span class="p">,</span> <span class="nx">ctrl2</span><span class="p">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Convert to percentage</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">p</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">adjust</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>Generate our control points</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ctrl1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="nx">p</span><span class="p">)];</span>
    <span class="nx">ctrl2</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">255</span> <span class="o">-</span> <span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="nx">p</span><span class="p">)),</span> <span class="mi">255</span><span class="p">];</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">adjust</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">ctrl1</span> <span class="o">=</span> <span class="nx">ctrl1</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>
      <span class="nx">ctrl2</span> <span class="o">=</span> <span class="nx">ctrl2</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>Simply call the curves filter with our generated arguments</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">curves</span><span class="p">(</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="nx">ctrl1</span><span class="p">,</span> <span class="nx">ctrl2</span><span class="p">,</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">]);</span>
  <span class="p">};</span>

<span class="p">}(</span><span class="nx">Caman</span><span class="p">));</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 